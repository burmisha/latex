import library.files
import library.tripod

import os

results = {
    '2019-05-7': [
        '2135313354135415 3513541452354533535',
        '4355424354345545 3514532455454232554',
        '4352412443234345 3414531555353433554',
        '2455313333144335 4314421543544423433',
        '5455515355344555 4413241354455344554',
        '3333333333333333 33333333333333_____',  # =(
        '5555555555555551 1555555155555153553',
        '4555134554345545 5415541554555443555',
        '5555455555555551 1555555155555254555',
        '5254222233222222 1212123454321234543',  # =(
        '5444414345144455 1414551145444244444',
        '4255434344334434 2422432344234333242',
        '4254234334334434 2523442344343332544',
        '45554_3454155435 3414_3_255141535543',
        '5335324555444543 3534353144334353545',
    ],
    '2019-05-8': [
        '5355314354145345 3515531355443133554',
        '3144514543144354 3412531342344_34443',
        '5255444555454552 154_5542_4345254542',
        '4444444444444442 2444244244444244444',
        '4245315355445434 2535544255543344543',
        '3243433234333233 4333432333333333333',
        '5455555455555552 1545255155555255555',
        '4455325455453554 2445553134435353555',
        '5444524234333434 4325552433333423325',
        '5355515555255555 1515552155555355555',
        '4444444444244444 4444442344444443442',
        '5555425445445554 2425552154445155554',
        '5454334454344344 352_441345444354455',
        '5553425555345554 1524354154444243555',
        '4355425455354355 1314442355345441545',
        '5555535355255544 45255_2455555355_55',
    ],
    '2019-05-11': [
        '5554534555455554 3544434424344132334',
        '5555555555554441 1555145145455154555',
        '4233343455433543 1535452234353152523',
        '3543214345554531 5445254534345345554',
        '5554443545544543 5444535344534533445',
        '4454343255545442 2444344224344243451',
        '5355423455555555 1534554145555253554',
        '5444345334445352 3443343233343243544',
        '255542455525535_ 2513551123454321234',  # =(
        '545542455525535_ 2513551123534143555',
        '4545545554255555 1515552145455453555',
        '4453433455535544 2424443234344342445',
        '5445514355444423 4425552352343334424',
        '455452414554_3_4 2553134352225322544',
        '4354324345544433 2435443343343332523',
        '5543234455443443 4544244223434142443',
        '5355335355335533 3535353355353355353',
    ],
    '2019-05-test': [
        '5435425142454452 333444553345__44553',
        '5445543542514242 454344455245__44552',
        '4354455435425351 55333444553345__445',
    ],
}


def getTripodReports():
    for className, personsResults in results.items():
        report = library.tripod.getEmptyReport(className)
        for personResult in personsResults:
            personResult = personResult.replace(' ', '').replace('-', '3').replace('_', '3')
            assert len(personResult) == 35
            for index, answer in enumerate(personResult, 1):
                report.AddAnswer(index, int(answer))
        yield className, report


def run(args):
    fileWriter = library.files.FileWriter()
    tripodFormat = args.format
    getText, extension = {
        'tex': (lambda r: r.GetTex(), 'tex'),
        'txt': (lambda r: r.GetText(), 'txt'),
    }[tripodFormat]
    for className, report in getTripodReports():
        fileWriter.Write(os.path.join('school-554', 'tripod'), className + '-tripod.%s' % extension, text=getText(report))


def populate_parser(parser):
    parser.add_argument('--format', help='Format', choices=['tex', 'txt'])
    parser.set_defaults(func=run)
